---
layout: presentation
title: Java 8 Lambdas and Streams
---
<div id="impress">
  <!-- slide-1 -->
  <div id="welcome" class="step slide" data-x="-1000" data-y="0">
    <q>Java 8 Lambdas and Streams</q>
    <p>Kostas Georgiadis (@kongeor)</p>
    <p>kongeor@gmail.com</p>
    <a href="http://kongeor.github.io/presentations/lambdas">http://kongeor.github.io/presentations/lambdas</a>
  </div> 

  <div id="cliché" class="step slide" data-x="0" data-y="0">
    <center><q><i>Cliché</i></q></center>
  </div> 

  <div id="outline" class="step slide" data-x="1000" data-y="0">
    <p class="title">Outline</p>
    <p>1. A little of <strong>Java</strong> history. <strong>JVM</strong> and alternative languages</p>
    <p>2. Worming up ... annoying examples</p>
    <p>3. <strong>@FunctionalInterface</strong></p>
    <p>4. Java <strong>Lambdas</strong></p>
    <p>5. Annoying examples pt.2</p>
    <p>6. <strong>Stream</strong> API</p>
  </div> 

  <div id="java-jvm" class="step slide" data-x="2000" data-y="0">
    <p class="title">Java & JVM</p>
    <p>The evolution of Java</p>
    <p>Java appeared in 1995</p>
    <p>Generics where added in 2004 (J2SE 5.0)<p>
    <p>Alternative JVM languages. Clojure, Groovy, Scala, JRuby, Jyphon, Rhino ...</p>
  </div> 

  <div id="yet-another" class="step slide" data-x="3000" data-y="0">
    <q>Yet another java major release?</q>
  </div>

  <div id="annoying-pt1" class="step slide" data-x="4000" data-y="0">
    <q>Annoying Examples pt1</q>
    <p>Note: no actual worms were harmed</p>
    <p>Q: Why worms and why these examples?</p>
  </div>

  <div id="worm-class" class="step slide" data-x="5000" data-y="0">
    {% highlight java %}
    public class Worm implements Creature {
        private static final int INITIAL_LIFE = 100;

        public enum Team {
            RED, BLUE, GREEN
        }

        private final String name;
        private final Team team;
        private int life;

        public Worm(String name, Team team) {
            this.name = name;
            this.team = team;
            life = INITIAL_LIFE;
        }
    ...
    {% endhighlight %}
  </div> 

  <div id="wormmanager-class" class="step slide" data-x="6000" data-y="0">
    {% highlight java %}
    public class WormsManager {

        private List<Worm> worms;

        public WormsManager() {
            worms = new ArrayList<>();
        }

        public List<Worm> getWorms() {
            return worms;
        }

        public void register(Worm worm) {
            worms.add(worm);
        }
    ...
    {% endhighlight %}
  </div> 

  <div id="sortbyname-comparator" class="step slide" data-x="7000" data-y="0">
    <div class="space100"></div>
    {% highlight java %}
    public void sortByName() {

        Comparator<Worm> namesComparator = new Comparator<Worm>() {
            @Override
            public int compare(Worm w1, Worm o2) {
                return w1.getName().compareTo(o2.getName());
            }
        };

        Collections.sort(worms, namesComparator);
    }
    {% endhighlight %}
  </div> 

  <div id="sortbynameandlife-comparator" class="step slide" data-x="8000" data-y="0">
    <div class="space100"></div>
    {% highlight java %}
    public void sortByNameAndLife() {

        Comparator<Worm> comparator = new Comparator<Worm>() {
            @Override
            public int compare(Worm w1, Worm w2) {
                int res = w1.getName().compareTo(w2.getName());
                return res != 0 ? res : w2.getLife() - w1.getLife();
            }
        };

        Collections.sort(worms, comparator);
    }
    {% endhighlight %}
  </div> 

  <div id="gettotallifeforteam" class="step slide" data-x="9000" data-y="0">
    <div class="space100"></div>
    {% highlight java %}
    public int getTotalLifeFor(Team team) {

        int life = 0;

        for (Worm worm : getWorms()) {
            if (worm.getTeam().equals(team)) {
                life += worm.getLife();
            }
        }

        return life;
    }
    {% endhighlight %}
  </div>

  <div id="getfirstdeadworm" class="step slide" data-x="10000" data-y="0">
    <div class="space100"></div>
    {% highlight java %}
    public Worm getFirstDeadWorm() {

        Worm dead = null;

        for (Worm worm : getWorms()) {
            if (!worm.isAlive()) {
                dead = worm;
                break;
            }
        }

        return dead;
    }
    {% endhighlight %}
  </div>

  <div id="getmostlively" class="step slide" data-x="11000" data-y="0">
    <div class="space100"></div>
    {% highlight java %}
    public Worm getMostLivelyWorm() {

        Worm lively = getWorms().get(0);

        for (Worm worm : getWorms()) {
            if (worm.getLife() > lively.getLife()) {
                lively = worm;
            }
        }

        return lively;
    }
    {% endhighlight %}
  </div>

  <div id="theproblem" class="step slide" data-x="12000" data-y="0">
    <q>Did you spot the problem?</q>
  </div>

  <div id="funint" class="step slide" data-x="13000" data-y="0">
    <q>Functional Interfaces</q>
    <p>The <span class="code">@FunctionalInterface</span> annotation</p>
    <p>Markers for SAM (single abstract method)</p>
    <p><strong>Default</strong> and <strong>static</strong> methods</p>
    <p>Multiple inheritance?</p>
  </div> 

  <div id="comparator8" class="step slide" data-x="14000" data-y="0">
    {% highlight java %}
    @FunctionalInterface
    public interface Comparator<T> {
        int compare(T o1, T o2);
        ...
        default Comparator<T> reversed() {
            return Collections.reverseOrder(this);
        }
        ...
        public static <T extends Comparable<? super T>> 
                Comparator<T> reverseOrder() {
            return Collections.reverseOrder();
        }
        ...
    }
    {% endhighlight %}
  </div> 

  <div id="mixin-example" class="step slide" data-x="15000" data-y="0">
    {% highlight java %}
    interface Foo {
        default void baz() {
            System.out.println("Foo::baz");
        }
    }

    interface Bar {
        default void baz() {
            System.out.println("Bar::baz");
        }
    }

    class Qux implements Foo, Bar {
        @Override
        public void baz() {
            System.out.println("Qux::baz");
        }
    }
    {% endhighlight %}
  </div> 

  <div id="lambda-scott" class="step slide" data-x="16000" data-y="0">
    <p><strong>Wallace Wells:</strong> If you want something bad, you have to fight for it. Step up your game, Scott. Break out the L-word.</q>
    <p><strong>Scott Pilgrim:</strong> Liquor?</p>
    <p><strong>Wallace Wells:</strong> The other L-word.</p>
    <p><strong>Scott Pilgrim:</strong> Love?</p>
    <p><strong>Wallace Wells:</strong> It's 'lambdas', Scott.</p>
    <p>(For the real quote <span class="abitup">&rarr;</span> <a class="reference" href="http://www.rottentomatoes.com/m/scott_pilgrims_vs_the_world/quotes/"> Scott Pilgrim vs. the World Quotes</a>)</p>
  </div>

  <div id="lambdas" class="step slide" data-x="0" data-y="1500">
    <q>Lambdas</q>
    <p>In computer programming, an anonymous function (also function constant, function literal, or lambda function) is a function defined, and possibly called, without being bound to an identifier. Anonymous functions are convenient to pass as an argument to a higher-order function and are ubiquitous in languages with first-class functions such as Haskell.</p>
    <a class="reference" href="http://en.wikipedia.org/wiki/Anonymous_function">( Wikipedia )</a>
  </div>

  <div id="more-annoying-examples" class="step slide" data-x="1000" data-y="1500">
    <q>More annoying examples please ...</q>
  </div>

  <div id="worm-predicate" class="step slide" data-x="2000" data-y="1500">
    {% highlight java %}
    @FunctionalInterface
    public interface WormPredicate {
        boolean test(Worm worm);
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    public List<Worm> filter(WormPredicate predicate) {
        List<Worm> filtered = new ArrayList<>();
        for (Worm worm : getWorms()) {
            if (predicate.test(worm)) {
                filtered.add(worm);
            }
        }
        return filtered;
    }
    {% endhighlight %}
  </div>

  <div id="worm-filter-predicate-sample" class="step slide" data-x="3000" data-y="1500">
    <div class="space100"></div>
    {% highlight java %}
    public List<Worm> getRedTeamDyingWorms() {
        return filter(new WormPredicate() {

            @Override
            public boolean test(Worm worm) {
                return worm.getLife() <= 10 &&
                       worm.getTeam().equals(Team.RED);
            }
        });
    }
    {% endhighlight %}
  </div>

  <div id="do-not-reinvent-the-wheel" class="step slide" data-x="4000" data-y="1500">
    <q>Do not reinvent the wheel</q>
  </div>


  <div id="process-example" class="step slide" data-x="5000" data-y="1500">
    {% highlight java %}
    import java.util.function.Consumer;
    import java.util.function.Predicate;

    public void process(Predicate<Worm> predicate,
                        Consumer<Worm> consumer) {
        for (Worm worm: getWorms()) {
            if (predicate.test(worm)) {
                consumer.accept(worm);
            }
        }
    }
    {% endhighlight %}
  </div>

  <div id="process-example-use" class="step slide" data-x="6000" data-y="1500">
    {% highlight java %}
    // WormsManager manager = WormsManager.createRandom(10);
    manager.process(new Predicate<Worm>() {
        
        @Override
        public boolean test(Worm worm) {
            return worm.isAlive();
        }
    }, new Consumer<Worm>() {
        
        @Override
        public void accept(Worm worm) {
            System.out.print(worm);
        }
    });
    {% endhighlight %}
  </div>

  <div id="arrow" class="step slide" data-x="7000" data-y="1500">
    <div class="space100"></div>
    <div class="space50"></div>
    <center><q>&rarr;</q></center>
  </div>

  <div id="lambda-basic-syntax" class="step slide" data-x="8000" data-y="1500">
    {% highlight java %}
    manager.process((Worm w) -> { return w.isAlive(); },
                    (Worm w) -> { System.out.print(w); });
    {% endhighlight %}
    <center><q>&darr;</q></center>
    {% highlight java %}
    manager.process(w -> w.isAlive(),
                    w -> System.out.print(w));
    {% endhighlight %}
  </div>

  <div id="method-references" class="step slide" data-x="9000" data-y="1500">
    <q>Method::References</q>
    <p>Convenient, easy-to-read lambda expressions</p>
  </div>

  <div id="process-function" class="step slide" data-x="10000" data-y="1500">
    {% highlight java %}
    public <T> void process(Function<Worm, T> function, 
                            Predicate<T> predicate,
                            Consumer<T> consumer) {
        for (Worm worm: getWorms()) {
            T result = function.apply(worm);
            if (predicate.test(result)) {
                consumer.accept(result);
            }
        }
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    manager.process(Worm::getName, n -> n.equals("Chuck"),
                                     System.out::println);
    manager.process(Function.identity(), Worm::isAlive,
                                     System.out::print);
    {% endhighlight %}
  </div>

  <div id="util-function" class="step slide" data-x="11000" data-y="1500">
    <q>Functional Interfaces of the java.util.function package</q>
    <p>Predicate</p>
    <p>Consumer</p>
    <p>Function</p>
    <p>Supplier</p>
    <p>UnaryOperator</p>
    <p>BinaryOperator</p>
  </div>

  <div id="lexical-scoping" class="step slide" data-x="12000" data-y="1500">
    <q>Lexical Scoping</q>
    <p>Unlike local and anonymous classes, lambdas do not introduce a new level of scoping</p>
  </div>

  <div id="scoping-example" class="step slide" data-x="13000" data-y="1500">
    {% highlight java %}
    public List<Worm> filterByName(String name) {
        return manager.filter(new WormPredicate() {
            @Override
            public boolean test(Worm worm) {
                // io.github.kongeor.demo.lambda.example.Scoping$1@7852e922
                System.out.println(this);
                return worm.getName().equals(name);
            }
        });
    }
    
    public List<Worm> filterByNameLambda(String name) {
        return manager.filter(w -> {
            // io.github.kongeor.demo.lambda.example.Scoping@36baf30c
            System.out.println(this);  
            return w.getName().equals(name);
        });
    }
    {% endhighlight %}
  </div>

  <div id="scoping-example-cont" class="step slide" data-x="14000" data-y="1500">
    {% highlight java %}
    public List<Worm> filterByName(String name) {
        return manager.filter(new WormPredicate() {
            @Override
            public boolean test(Worm worm) {
                String name = "Jean-Claude";
                return worm.getName().equals(name);
            }
        });
    }
    
    public List<Worm> filterByNameLambda(String name) {
        return manager.filter(w -> {
            // String name = "Steven"; // Cannot redeclare
            System.out.println(this);  
            return w.getName().equals(name);
        });
    }
    {% endhighlight %}
  </div>

  <div id="effectively-final" class="step slide" data-x="15000" data-y="1500">
    {% highlight java %}
    public List<Worm> filterByName(String name) {
        return manager.filter(new WormPredicate() {
            @Override
            public boolean test(Worm worm) {
                // name = "Jean-Claude"; // effectively final
                return worm.getName().equals(name);
            }
        });
    }
    
    public List<Worm> filterByNameLambda(String name) {
        // name = "Steven"; // effectively final
        return manager.filter(w -> {
            System.out.println(this);  
            return w.getName().equals(name);
        });
    }
    {% endhighlight %}
  </div>

  <div id="loop-hunting" class="step slide" data-x="16000" data-y="1500">
    <center>
      <q>It's time for ... for loop hunting!</q>
    <center>
  </div>
  

  <div id="streams-intro" class="step slide" data-x="0" data-y="3000">
    <q>Streams</q>
    <p>Streams are wrappers around collections that provide aggregate operations 
    (filter, map, forEach, reduce, etc ...) that are lazily evaluated and can
    provide parallel execution for free.</p>
  </div>

  <div id="stream-foreach" class="step slide" data-x="1000" data-y="3000">
    {% highlight java %}
    public void boost(int amount) {
        for (Worm worm: getWorms()) {
            worm.setLife(worm.getLife() + amount);
        }
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    public void boost(int amount) {
        // Iterable
        getWorms().forEach(w -> w.setLife(w.getLife() + amount));
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    public void boost(int amount) {
        // Stream
        getWorms().stream().forEach(w -> w.setLife(w.getLife() + amount));
    }
    {% endhighlight %}
  </div>

  <div id="stream-filter-reduce" class="step slide" data-x="2000" data-y="3000">
    {% highlight java %}
    public int getTotalLifeFor(Team team) {
        int life = 0;
        for (Worm worm : getWorms()) {
            if (worm.getTeam().equals(team)) {
                life += worm.getLife();
            }
        }
        return life;
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    return getWorms().stream()
                     .filter(w -> w.getTeam().equals(team))
                     .map(Worm::getLife)
                     .reduce(0, (x, y) -> x + y).intValue();
    {% endhighlight %}
    <hr />
    {% highlight java %}
    return getWorms().stream().filter(...).mapToInt(Worm::getLife).sum();
    {% endhighlight %}
  </div>

  <div id="stream-find-optional" class="step slide" data-x="3000" data-y="3000">
    {% highlight java %}
    public Worm getFirstDeadWorm() {
        Worm dead = null;
        for (Worm worm : getWorms()) {
            if (!worm.isAlive()) {
                dead = worm;
                break;
            }
        }
        return dead;
    }
    {% endhighlight %}
    <hr />
    {% highlight java %}
    public Worm getFirstDeadWorm() {
        return getWorms().stream()
                         .filter(w -> !w.isAlive())
                         .findFirst()
                         .orElse(null);
    }
    {% endhighlight %}
  </div>

  <div id="overview" class="step" data-x="8000" data-y="1500" data-scale="15">
  </div>
</div>

